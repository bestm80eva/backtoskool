<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Back to Skool: Routine at 20956</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../bts.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="Back to Skool" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="20896.html">20896</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#20956">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="21152.html">21152</a></span></td>
</tr>
</table>
<div class="description">20956: Guide a character onto the catwalk or off it</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="21152.html">21152</a>. Makes a character walk in from the left to the middle of the screen (at which point his name may be changed), or from the middle of the screen and off to the right.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="20956"></a>20956</td>
<td class="instruction">LD B,40</td>
<td class="comment-11" rowspan="1">The character will walk 40 paces</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="20958"></a>20958</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20959"></a>20959</td>
<td class="instruction">LD H,210</td>
<td class="comment-11" rowspan="1">We use ERIC's buffer at page 210 to control the character</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20961"></a>20961</td>
<td class="instruction">CALL <a class="link" href="25012.html">25012</a></td>
<td class="comment-11" rowspan="1">Update the SRB for the character's current animatory state and location</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="20964"></a>20964</td>
<td class="instruction">INC A</td>
<td class="comment-11" rowspan="2"><span class="register">A</span>=character's next animatory state</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20965"></a>20965</td>
<td class="instruction">AND 251</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20967"></a>20967</td>
<td class="instruction">BIT 0,A</td>
<td class="comment-11" rowspan="1">Is the character midstride now?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20969"></a>20969</td>
<td class="instruction">JR NZ,20972</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20971"></a>20971</td>
<td class="instruction">INC E</td>
<td class="comment-11" rowspan="1">Otherwise move forward a pace</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="20972"></a>20972</td>
<td class="instruction">CALL <a class="link" href="24880.html">24880</a></td>
<td class="comment-11" rowspan="1">Update the character's animatory state and location and update the SRB</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20975"></a>20975</td>
<td class="instruction">CALL <a class="link" href="25248.html">25248</a></td>
<td class="comment-11" rowspan="1">Update the display</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20978"></a>20978</td>
<td class="instruction">CALL <a class="link" href="21419.html">21419</a></td>
<td class="comment-11" rowspan="1">Make a walking sound effect</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20981"></a>20981</td>
<td class="instruction">LD C,100</td>
<td class="comment-11" rowspan="4">Wait a bit</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="20983"></a>20983</td>
<td class="instruction">DJNZ 20983</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20985"></a>20985</td>
<td class="instruction">DEC C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20986"></a>20986</td>
<td class="instruction">JR NZ,20983</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20988"></a>20988</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20989"></a>20989</td>
<td class="instruction">DJNZ 20958</td>
<td class="comment-11" rowspan="1">Jump back until all 40 paces have been walked</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="20991"></a>20991</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="20896.html">20896</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#20956">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="21152.html">21152</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Back to Skool RAM disassembly 20150415</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd (Back to Skool). &#169; 2015 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 4.3.</div>
</div>
</body>
</html>