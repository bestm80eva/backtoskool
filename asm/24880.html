<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Back to Skool: Routine at 24880</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../microsphere.css" />
<link rel="stylesheet" type="text/css" href="../skool.css" />
<link rel="stylesheet" type="text/css" href="../bts.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="24878.html">24878</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#24880">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="25011.html">25011</a></span></td>
</tr>
</table>
<div class="description">24880: Update a character's animatory state and location and update the SRB</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by many routines. Sets the new animatory state and location of a character, and updates the <a class="link" href="32512.html">screen refresh buffer</a> (SRB) accordingly.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">New animatory state</td>
</tr>
<tr>
<td class="register">D</td>
<td class="register-desc">New y-coordinate (3-17)</td>
</tr>
<tr>
<td class="register">E</td>
<td class="register-desc">New x-coordinate (0-189)</td>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">Character number (183-214)</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24880"></a>24880</td>
<td class="instruction">LD L,2</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at byte 2 of the character's buffer</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24882"></a>24882</td>
<td class="instruction">LD (HL),D</td>
<td class="comment-11" rowspan="1">Fill in the new y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24883"></a>24883</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=1</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24884"></a>24884</td>
<td class="instruction">LD (HL),E</td>
<td class="comment-11" rowspan="1">Fill in the new x-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24885"></a>24885</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=0</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24886"></a>24886</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-11" rowspan="1">Fill in the new animatory state</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24887"></a>24887</td>
<td class="instruction">LD C,A</td>
<td class="comment-11" rowspan="1"><span class="register">C</span>=new animatory state</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24888"></a>
<div class="comments">
<div class="paragraph">
This entry point is used by the routine at <a class="link" href="25012.html">25012</a> to update the SRB for the current animatory state and location of the character.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24888"></a>24888</td>
<td class="instruction">LD A,(32767)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=leftmost column of the play area on screen (0-160)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24891"></a>24891</td>
<td class="instruction">SUB 3</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24893"></a>24893</td>
<td class="instruction">JR C,24897</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24895"></a>24895</td>
<td class="instruction">CP E</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24896"></a>24896</td>
<td class="instruction">RET NC</td>
<td class="comment-11" rowspan="1">Return if the character is entirely off-screen to the left</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24897"></a>24897</td>
<td class="instruction">ADD A,34</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24899"></a>24899</td>
<td class="instruction">CP E</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24900"></a>24900</td>
<td class="instruction">RET C</td>
<td class="comment-11" rowspan="1">Return if the character is entirely off-screen to the right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24901"></a>24901</td>
<td class="instruction">SUB 32</td>
<td class="comment-11" rowspan="3"><span class="register">A</span>=<span class="register">E</span>-(<a class="link" href="32767.html">32767</a>): the character's relative x-coordinate (-2 to 31)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24903"></a>24903</td>
<td class="instruction">CPL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24904"></a>24904</td>
<td class="instruction">ADD A,E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24905"></a>24905</td>
<td class="instruction">LD B,3</td>
<td class="comment-11" rowspan="1">The sprites are 3 tiles wide</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24907"></a>24907</td>
<td class="instruction">PUSH HL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24908"></a>24908</td>
<td class="instruction">LD H,215</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24910"></a>24910</td>
<td class="instruction">CP 254</td>
<td class="comment-11" rowspan="1">Is the character either fully on-screen or walking off it to the right?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24912"></a>24912</td>
<td class="instruction">JR C,24924</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24914"></a>24914</td>
<td class="instruction">LD H,219</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24916"></a>24916</td>
<td class="instruction">DEC B</td>
<td class="comment-11" rowspan="1"><span class="register">B</span>=2</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24917"></a>24917</td>
<td class="instruction">INC A</td>
<td class="comment-11" rowspan="1">Is the character one-third off (two-thirds on) at the left?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24918"></a>24918</td>
<td class="instruction">JR Z,24924</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24920"></a>24920</td>
<td class="instruction">LD H,223</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24922"></a>24922</td>
<td class="instruction">DEC B</td>
<td class="comment-11" rowspan="1"><span class="register">B</span>=1 (the character is one-third on-screen at the left)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24923"></a>24923</td>
<td class="instruction">XOR A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24924"></a>24924</td>
<td class="instruction">LD E,A</td>
<td class="comment-11" rowspan="1"><span class="register">E</span>=leftmost column of the screen occupied by the character's sprite (0-31)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24925"></a>24925</td>
<td class="instruction">SUB 30</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24927"></a>24927</td>
<td class="instruction">JR C,24932</td>
<td class="comment-11" rowspan="1">Jump if the character is one- or two-thirds off-screen to the right</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24929"></a>24929</td>
<td class="instruction">CPL</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24930"></a>24930</td>
<td class="instruction">ADD A,B</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24931"></a>24931</td>
<td class="instruction">LD B,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24932"></a>
<div class="comments">
<div class="paragraph">
Now <span class="register">B</span> holds a value (1, 2 or 3) equal to the number of columns of the screen occupied by the character's sprite.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24932"></a>24932</td>
<td class="instruction">LD L,C</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=animatory state</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24933"></a>24933</td>
<td class="instruction">LD C,0</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24935"></a>24935</td>
<td class="instruction">BIT 7,L</td>
<td class="comment-11" rowspan="1">Is the character facing left?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24937"></a>24937</td>
<td class="instruction">JR Z,24945</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24939"></a>24939</td>
<td class="instruction">LD C,248</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24941"></a>24941</td>
<td class="instruction">LD A,182</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24943"></a>24943</td>
<td class="instruction">SUB H</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24944"></a>24944</td>
<td class="instruction">LD H,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24945"></a>
<div class="comments">
<div class="paragraph">
Now <span class="register">H</span> holds 215, 219 or 223 - the page containing the UDG reference for the tile on the top row of the leftmost column of the sprite that is on-screen. <span class="register">C</span> is 0 if the character is facing left, or -8 if he's facing right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24945"></a>24945</td>
<td class="instruction">SET 7,L</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at the UDG reference for the sprite tile</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24947"></a>24947</td>
<td class="instruction">LD A,E</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=leftmost column of the screen occupied by the sprite (0-31)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24948"></a>24948</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24949"></a>24949</td>
<td class="instruction">AND 7</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24951"></a>24951</td>
<td class="instruction">ADD A,120</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24953"></a>24953</td>
<td class="instruction">LD L,A</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24954"></a>24954</td>
<td class="instruction">LD H,225</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24956"></a>24956</td>
<td class="instruction">LD C,(HL)</td>
<td class="comment-11" rowspan="1">Pick up a byte from the table at <a class="link" href="57720.html">57720</a></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24957"></a>24957</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24958"></a>
<div class="comments">
<div class="paragraph">
Now <span class="register">C'</span> holds 1, 2, 4, 8, 16, 32, 64 or 128. The bit set in <span class="register">C'</span> corresponds to the bit that needs to be set in the relevant byte of the screen refresh buffer (SRB).
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24958"></a>24958</td>
<td class="instruction">LD A,E</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=leftmost column of the screen occupied by the sprite</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24959"></a>24959</td>
<td class="instruction">RRCA</td>
<td class="comment-11" rowspan="8">Set <span class="register">A</span> to the LSB of the first byte of the SRB that needs to be modified</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24960"></a>24960</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24961"></a>24961</td>
<td class="instruction">RRCA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24962"></a>24962</td>
<td class="instruction">AND 3</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24964"></a>24964</td>
<td class="instruction">ADD A,D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24965"></a>24965</td>
<td class="instruction">ADD A,D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24966"></a>24966</td>
<td class="instruction">ADD A,D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24967"></a>24967</td>
<td class="instruction">ADD A,D</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24968"></a>24968</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24969"></a>24969</td>
<td class="instruction">LD B,A</td>
<td class="comment-11" rowspan="1">Copy this LSB to <span class="register">B'</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24970"></a>24970</td>
<td class="instruction">LD H,127</td>
<td class="comment-11" rowspan="1">The SRB starts at page 127 (<a class="link" href="32512.html">32512</a>)</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="24972"></a>
<div class="comments">
<div class="paragraph">
Here we enter a loop to set the appropriate bits in the SRB.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24972"></a>24972</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24973"></a>24973</td>
<td class="instruction">LD E,0</td>
<td class="comment-11" rowspan="1"><span class="register">E</span> will count up to 4 (the number of rows occupied by a sprite)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24975"></a>24975</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Pick up the sprite tile UDG reference in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24976"></a>24976</td>
<td class="instruction">AND A</td>
<td class="comment-11" rowspan="1">Is this the 'null' UDG (blank square)?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24977"></a>24977</td>
<td class="instruction">JR Z,24989</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24979"></a>24979</td>
<td class="instruction">LD A,E</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=sprite tile row number (0-3)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24980"></a>24980</td>
<td class="instruction">ADD A,A</td>
<td class="comment-11" rowspan="2">Multiply by 4 (the number of bytes of the SRB that correspond to one row of the screen)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24981"></a>24981</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24982"></a>24982</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24983"></a>24983</td>
<td class="instruction">ADD A,B</td>
<td class="comment-11" rowspan="2">Point <span class="register">HL'</span> at the relevant byte of the SRB</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24984"></a>24984</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24985"></a>24985</td>
<td class="instruction">LD A,C</td>
<td class="comment-11" rowspan="1">The bit set in <span class="register">A</span> is the bit that needs setting in the SRB byte</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24986"></a>24986</td>
<td class="instruction">OR (HL)</td>
<td class="comment-11" rowspan="2">Set the bit in the SRB</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24987"></a>24987</td>
<td class="instruction">LD (HL),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24988"></a>24988</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="24989"></a>24989</td>
<td class="instruction">INC H</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at the UDG reference for the next tile in the sprite (one row down)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24990"></a>24990</td>
<td class="instruction">INC E</td>
<td class="comment-11" rowspan="1">Next row down in this column of the sprite</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24991"></a>24991</td>
<td class="instruction">BIT 2,E</td>
<td class="comment-11" rowspan="1">Have we done all four rows yet?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24993"></a>24993</td>
<td class="instruction">JR Z,24975</td>
<td class="comment-11" rowspan="1">Jump back if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24995"></a>24995</td>
<td class="instruction">DEC B</td>
<td class="comment-11" rowspan="1">Have we done all the columns occupied by the sprite yet?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24996"></a>24996</td>
<td class="instruction">JR Z,25009</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24998"></a>24998</td>
<td class="instruction">LD A,H</td>
<td class="comment-11" rowspan="3">Point <span class="register">HL</span> at the UDG reference for the tile in the top row of the next column of the sprite (<span class="register">C</span>=0 if the character's facing left, -8 if facing right)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="24999"></a>24999</td>
<td class="instruction">ADD A,C</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25000"></a>25000</td>
<td class="instruction">LD H,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25001"></a>25001</td>
<td class="instruction">EXX</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25002"></a>25002</td>
<td class="instruction">RRC C</td>
<td class="comment-11" rowspan="1">Move the SRB marker bit one place to the right (possibly wrapping round to bit 7)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25004"></a>25004</td>
<td class="instruction">JR NC,24972</td>
<td class="comment-11" rowspan="1">Jump back if there are still bits to be set in the current SRB byte</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25006"></a>25006</td>
<td class="instruction">INC B</td>
<td class="comment-11" rowspan="1">Otherwise move to the next SRB byte</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25007"></a>25007</td>
<td class="instruction">JR 24972</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="25009"></a>25009</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Restore the character number to <span class="register">H</span> (<span class="register">L</span>=0)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="25010"></a>25010</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="24878.html">24878</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#24880">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="25011.html">25011</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Back to Skool RAM disassembly 20140614</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd (Back to Skool). &#169; 2014 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://pyskool.ca/?page_id=177">SkoolKit</a> 4.0.</div>
</div>
</body>
</html>