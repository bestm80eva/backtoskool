<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Back to Skool: Routine at 32032</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../microsphere.css" />
<link rel="stylesheet" type="text/css" href="../skool.css" />
<link rel="stylesheet" type="text/css" href="../bts.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="32021.html">32021</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#32032">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="32054.html">32054</a></span></td>
</tr>
</table>
<div class="description">32032: Make any nearby teacher give ERIC lines if necessary (1)</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="63156.html">63156</a>. Makes any nearby teacher give ERIC lines for rule breakages other than hitting, firing a catapult, firing a waterpistol, writing on a blackboard, or dropping a stinkbomb.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="32032"></a>32032</td>
<td class="instruction">LD HL,32758</td>
<td class="comment-11" rowspan="2">Decrement the LSB of the lines-giving delay counter at <a class="link" href="32758.html">32758</a></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32035"></a>32035</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32036"></a>32036</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return unless it's time to inspect the MSB</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32037"></a>32037</td>
<td class="instruction">LD (HL),15</td>
<td class="comment-11" rowspan="1">Reset the LSB to 15</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32039"></a>32039</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1"><span class="register">HL</span>=<a class="link" href="32759.html">32759</a> (MSB of the lines-giving delay counter)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32040"></a>32040</td>
<td class="instruction">INC (HL)</td>
<td class="comment-11" rowspan="2">Has the lines-giving delay counter reached 0?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32041"></a>32041</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32042"></a>32042</td>
<td class="instruction">JR Z,32049</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32044"></a>32044</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-11" rowspan="1">Otherwise decrement the MSB of the counter</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32045"></a>32045</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Pick up the MSB in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32046"></a>32046</td>
<td class="instruction">CP 6</td>
<td class="comment-11" rowspan="1">Has enough time passed since the last time ERIC was given lines?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32048"></a>32048</td>
<td class="instruction">RET NC</td>
<td class="comment-11" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="32049"></a>
<div class="comments">
<div class="paragraph">
The MSB of the lines-giving delay counter (which is reset to 10 by the routine at <a class="link" href="32062.html">32062</a> when ERIC is given lines) is now 5 or less. This means the minimum interval between two lines-givings (75 passes through the main loop) has elapsed. However, the teacher who gave ERIC lines last time must wait until the MSB reaches zero before he can give ERIC lines again.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="32049"></a>32049</td>
<td class="instruction">CALL <a class="link" href="32000.html">32000</a></td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=<a class="link" href="25554.html#ericLocTable">location identifier</a> for ERIC</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="32052"></a>32052</td>
<td class="instruction">JR <a class="link" href="32062.html">32062</a></td>
<td class="comment-11" rowspan="1">Skip over the routine at <a class="link" href="32054.html">32054</a></td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="32021.html">32021</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#32032">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="32054.html">32054</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Back to Skool RAM disassembly 20140614</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd (Back to Skool). &#169; 2014 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://pyskool.ca/?page_id=177">SkoolKit</a> 4.0.</div>
</div>
</body>
</html>