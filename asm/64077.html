<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Back to Skool: Routine at 64077</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../bts.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="Back to Skool" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="64076.html">64076</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#64077">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="64241.html">64241</a></span></td>
</tr>
</table>
<div class="description">64077: Deal with water fired from the pistol at certain phases</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="63915.html">63915</a>. On entry, <span class="register">A</span> is equal to 1 if the water is at phase 3 of its trajectory (at which point it may hit a cup), or 2 if it's at phase 6 or above (at which point it may hit a plant or the floor). In the following, 'water' may refer to either water or sherry.
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">A</td>
<td class="register-desc">1 or 2</td>
</tr>
<tr>
<td class="register">H</td>
<td class="register-desc">214 (water)</td>
</tr>
<tr>
<td class="register">L</td>
<td class="register-desc">19</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64077"></a>64077</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1">Is the water at the right phase to fill a cup?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64078"></a>64078</td>
<td class="instruction">JR NZ,64126</td>
<td class="comment-11" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64080"></a>64080</td>
<td class="instruction">LD L,2</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at byte 2 of the water's buffer</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64082"></a>64082</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=water's y-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64083"></a>64083</td>
<td class="instruction">SUB 14</td>
<td class="comment-11" rowspan="1">All cups have a y-coordinate of 14</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64085"></a>64085</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if the water's not at the right height</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64086"></a>64086</td>
<td class="instruction">LD L,A</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=0</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64087"></a>64087</td>
<td class="instruction">DEC A</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=-1</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64088"></a>64088</td>
<td class="instruction">BIT 7,(HL)</td>
<td class="comment-11" rowspan="1">Is the water travelling to the left?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64090"></a>64090</td>
<td class="instruction">JR Z,64094</td>
<td class="comment-11" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64092"></a>64092</td>
<td class="instruction">LD A,3</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64094"></a>64094</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=1</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64095"></a>64095</td>
<td class="instruction">ADD A,(HL)</td>
<td class="comment-11" rowspan="1">Now <span class="register">A</span>=x-coordinate of the spot the water is hitting</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64096"></a>64096</td>
<td class="instruction">CALL <a class="link" href="30205.html#30217">30217</a></td>
<td class="comment-11" rowspan="1">Is this the x-coordinate of one of the cups?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64099"></a>64099</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64100"></a>64100</td>
<td class="instruction">LD HL,32747</td>
<td class="comment-11" rowspan="1"><a class="link" href="32747.html">32747</a> holds the inventory flags</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64103"></a>64103</td>
<td class="instruction">BIT 4,(HL)</td>
<td class="comment-11" rowspan="1">Set the zero flag if there's water (not sherry) in the pistol</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64105"></a>64105</td>
<td class="instruction">LD HL,56439</td>
<td class="comment-11" rowspan="1"><span class="register">H</span>=220, <span class="register">L</span>=119</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64108"></a>64108</td>
<td class="instruction">JR Z,64112</td>
<td class="comment-11" rowspan="1">Jump if there's water in the pistol</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64110"></a>64110</td>
<td class="instruction">LD L,124</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64112"></a>64112</td>
<td class="instruction">INC H</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at a cup graphic data table</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64113"></a>64113</td>
<td class="instruction">CP (HL)</td>
<td class="comment-11" rowspan="1">Is this the right data table for the cup?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64114"></a>64114</td>
<td class="instruction">JR NZ,64112</td>
<td class="comment-11" rowspan="1">Jump back to check the next table if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64116"></a>64116</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at the appropriate UDG reference table</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="64117"></a>
<div class="comments">
<div class="paragraph">
Now <span class="register">HL</span> points at the start of the appropriate UDG reference table for the cup:
</div>
<div class="paragraph">
<table class="default">
<tr>
<th colspan="1" rowspan="1"><span class="register">HL</span></th>
<th colspan="1" rowspan="1">Cup</th>
<th colspan="1" rowspan="1">Contents</th>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="56694.html">56694</a></td>
<td class="" colspan="1" rowspan="1">Leftmost cup in the boys' skool</td>
<td class="" colspan="1" rowspan="1">Water</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="56699.html">56699</a></td>
<td class="" colspan="1" rowspan="1">Leftmost cup in the boys' skool</td>
<td class="" colspan="1" rowspan="1">Sherry</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="56950.html">56950</a></td>
<td class="" colspan="1" rowspan="1">Middle cup in the boys' skool</td>
<td class="" colspan="1" rowspan="1">Water</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="56955.html">56955</a></td>
<td class="" colspan="1" rowspan="1">Middle cup in the boys' skool</td>
<td class="" colspan="1" rowspan="1">Sherry</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="57206.html">57206</a></td>
<td class="" colspan="1" rowspan="1">Rightmost cup in the boys' skool</td>
<td class="" colspan="1" rowspan="1">Water</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="57211.html">57211</a></td>
<td class="" colspan="1" rowspan="1">Rightmost cup in the boys' skool</td>
<td class="" colspan="1" rowspan="1">Sherry</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="57462.html">57462</a></td>
<td class="" colspan="1" rowspan="1">Cup in the girls' skool</td>
<td class="" colspan="1" rowspan="1">Water</td>
</tr>
<tr>
<td class="" colspan="1" rowspan="1"><a class="link" href="57467.html">57467</a></td>
<td class="" colspan="1" rowspan="1">Cup in the girls' skool</td>
<td class="" colspan="1" rowspan="1">Sherry</td>
</tr>
</table>
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64117"></a>64117</td>
<td class="instruction">CALL <a class="link" href="27672.html">27672</a></td>
<td class="comment-11" rowspan="1">Alter the appropriate UDG and attribute references in the play area to show the cup filled with water or sherry</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64120"></a>64120</td>
<td class="instruction">POP HL</td>
<td class="comment-11" rowspan="1">Drop the return address (to the routine at <a class="link" href="63915.html">63915</a>) from the stack</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64121"></a>64121</td>
<td class="instruction">LD H,214</td>
<td class="comment-11" rowspan="1">214=water</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64123"></a>64123</td>
<td class="instruction">JP <a class="link" href="29896.html#29903">29903</a></td>
<td class="comment-11" rowspan="1">Remove the water from sight</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="64126"></a>
<div class="comments">
<div class="paragraph">
The water is at phase 6 or above of its trajectory. Has it hit the floor?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64126"></a>64126</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-11" rowspan="1">Decrement the water animation phase identifier in byte 19 of the water's buffer from 156 to 155; this has the effect of bringing us back through this section of code (via the routine at <a class="link" href="63915.html">63915</a>) until the water has hit either a plant or the floor</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64127"></a>64127</td>
<td class="instruction">CALL <a class="link" href="30543.html">30543</a></td>
<td class="comment-11" rowspan="1">Is the water's y-coordinate 3 (top floor), 10 (middle floor) or 17 (bottom floor)?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64130"></a>64130</td>
<td class="instruction">JR NZ,64147</td>
<td class="comment-11" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64132"></a>64132</td>
<td class="instruction">CP 17</td>
<td class="comment-11" rowspan="1">Did it hit the bottom floor?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64134"></a>64134</td>
<td class="instruction">JR Z,64120</td>
<td class="comment-11" rowspan="1">Terminate the water if so</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="64136"></a>
<div class="comments">
<div class="paragraph">
The water has reached the level of the top or middle floor. We terminate it here if it's inside the boys' skool or the girls' skool. (Note that it hasn't necessarily hit the floor at this point; for example, it may have been fired from the top of the stairs above the stage down onto the stage, in which case it will terminate in mid-air above the stage, at the level of the middle floor.) Otherwise we let it continue till it hits the ground.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64136"></a>64136</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1"><span class="register">L</span>=1</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64137"></a>64137</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=water's x-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64138"></a>64138</td>
<td class="instruction">CP 96</td>
<td class="comment-11" rowspan="4">Terminate the water if <span class="register">A</span>&lt;96 (it's inside the boys' skool) or <span class="register">A</span>&gt;=160 (it's inside the girls' skool)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64140"></a>64140</td>
<td class="instruction">JR C,64120</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64142"></a>64142</td>
<td class="instruction">CP 160</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64144"></a>64144</td>
<td class="instruction">JR NC,64120</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64146"></a>64146</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="64147"></a>
<div class="comments">
<div class="paragraph">
The water hasn't hit a cup or the floor. Has it hit a plant pot?
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64147"></a>64147</td>
<td class="instruction">CALL <a class="link" href="63878.html">63878</a></td>
<td class="comment-11" rowspan="1">Has the water hit a plant pot?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64150"></a>64150</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64151"></a>64151</td>
<td class="instruction">LD A,(32747)</td>
<td class="comment-11" rowspan="1"><a class="link" href="32747.html">32747</a> holds the inventory flags</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64154"></a>64154</td>
<td class="instruction">BIT 4,A</td>
<td class="comment-11" rowspan="1">Has the pistol got sherry in it?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64156"></a>64156</td>
<td class="instruction">JR NZ,64120</td>
<td class="comment-11" rowspan="1">Terminate the sherry if so (sherry does not make plants grow)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64158"></a>64158</td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1">Drop the return address (to the routine at <a class="link" href="63915.html">63915</a>) from the stack</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64159"></a>64159</td>
<td class="instruction">CALL <a class="link" href="25012.html">25012</a></td>
<td class="comment-11" rowspan="1">Update the SRB for the water's current animatory state and location</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64162"></a>64162</td>
<td class="instruction">INC D</td>
<td class="comment-11" rowspan="1">Now <span class="register">D</span>=y-coordinate of the plant</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64163"></a>64163</td>
<td class="instruction">LD L,19</td>
<td class="comment-11" rowspan="2">Initialise the counter that determines the phases of growth of the watered plant</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64165"></a>64165</td>
<td class="instruction">LD (HL),22</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64167"></a>64167</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="2">Store the x-coordinate of the plant in byte 20 of the buffer for retrieval later when it starts growing</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64168"></a>64168</td>
<td class="instruction">LD (HL),E</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64169"></a>64169</td>
<td class="instruction">LD E,0</td>
<td class="comment-11" rowspan="1">The plant's initial x-coordinate will be 0 (which is certainly off-screen at the moment, since the leftmost plant pot is at x-coordinate 91)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64171"></a>64171</td>
<td class="instruction">LD A,E</td>
<td class="comment-11" rowspan="1">And its initial animatory state will be <a class="link" href="../graphics/as.html#0">0</a> (ERIC standing, facing left), so it's a good thing it will be off-screen!</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64172"></a>64172</td>
<td class="instruction">CALL <a class="link" href="30534.html">30534</a></td>
<td class="comment-11" rowspan="1">Place address <a class="link" href="64077.html#64175">64175</a> (below) into bytes 17 and 18 of the plant's buffer and update the SRB for the plant's appearance</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="64175"></a>
<div class="comments">
<div class="paragraph">
The address of this entry point is placed into bytes 17 and 18 of the plant's buffer by the instruction above just after the plant has been watered.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64175"></a>64175</td>
<td class="instruction">LD L,19</td>
<td class="comment-11" rowspan="1">Byte 19 holds the counter that determines the phases of growth (and death) of the plant</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64177"></a>64177</td>
<td class="instruction">DEC (HL)</td>
<td class="comment-11" rowspan="1">Is the plant ready to die?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64178"></a>64178</td>
<td class="instruction">JR NZ,64195</td>
<td class="comment-11" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64180"></a>64180</td>
<td class="instruction">LD A,(32749)</td>
<td class="comment-11" rowspan="1"><a class="link" href="32749.html">32749</a> holds ERIC's secondary status flags</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64183"></a>64183</td>
<td class="instruction">CP 2</td>
<td class="comment-11" rowspan="1">Is ERIC standing on a plant or plant pot?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64185"></a>64185</td>
<td class="instruction">JR NZ,64192</td>
<td class="comment-11" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64187"></a>64187</td>
<td class="instruction">LD A,16</td>
<td class="comment-11" rowspan="2">Set bit 4 at <a class="link" href="32749.html">32749</a>, indicating that ERIC is going to take a fall (even if ERIC's standing on a different plant pot; this is a <a class="link" href="../reference/bugs.html#plant">bug</a>)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64189"></a>64189</td>
<td class="instruction">LD (32749),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64192"></a>64192</td>
<td class="instruction">JP <a class="link" href="29896.html#29903">29903</a></td>
<td class="comment-11" rowspan="1">Kill the plant</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="64195"></a>
<div class="comments">
<div class="paragraph">
The plant is not dead yet. Plan its next move.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64195"></a>64195</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-11" rowspan="1">Pick up the plant lifespan counter in <span class="register">A</span></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64196"></a>64196</td>
<td class="instruction">CP 8</td>
<td class="comment-11" rowspan="1">Is it time for the plant to start growing?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64198"></a>64198</td>
<td class="instruction">JR NZ,64209</td>
<td class="comment-11" rowspan="1">Jump if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64200"></a>64200</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="2"><span class="register">E</span>=x-coordinate of the plant (stored in byte 20 earlier)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64201"></a>64201</td>
<td class="instruction">LD E,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64202"></a>64202</td>
<td class="instruction">LD L,2</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at byte 2 of the plant's buffer</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64204"></a>64204</td>
<td class="instruction">LD D,(HL)</td>
<td class="comment-11" rowspan="1"><span class="register">D</span>=y-coordinate of the plant</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64205"></a>64205</td>
<td class="instruction">LD A,42</td>
<td class="comment-11" rowspan="1"><a class="link" href="../graphics/as.html#42">42</a>: flower, half-grown</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64207"></a>64207</td>
<td class="instruction">JR 64216</td>
<td class="comment-11" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64209"></a>64209</td>
<td class="instruction">CP 4</td>
<td class="comment-11" rowspan="1">Is it time for the plant to reach full height?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64211"></a>64211</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64212"></a>64212</td>
<td class="instruction">CALL <a class="link" href="25012.html">25012</a></td>
<td class="comment-11" rowspan="1">Update the SRB for the plant's current animatory state</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64215"></a>64215</td>
<td class="instruction">INC A</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=<a class="link" href="../graphics/as.html#43">43</a>: flower, fully grown</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="64216"></a>64216</td>
<td class="instruction">CALL <a class="link" href="24880.html">24880</a></td>
<td class="comment-11" rowspan="1">Update the plant's animatory state and update the SRB</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64219"></a>64219</td>
<td class="instruction">LD A,(32749)</td>
<td class="comment-11" rowspan="1"><a class="link" href="32749.html">32749</a> holds ERIC's status flags</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64222"></a>64222</td>
<td class="instruction">CP 2</td>
<td class="comment-11" rowspan="1">Is ERIC standing on a plant?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64224"></a>64224</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64225"></a>64225</td>
<td class="instruction">LD A,(53761)</td>
<td class="comment-11" rowspan="1"><span class="register">A</span>=ERIC's x-coordinate</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64228"></a>64228</td>
<td class="instruction">LD L,1</td>
<td class="comment-11" rowspan="1">Point <span class="register">HL</span> at byte 1 of the plant's buffer (which holds its x-coordinate)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64230"></a>64230</td>
<td class="instruction">CP (HL)</td>
<td class="comment-11" rowspan="1">Is ERIC standing on this plant?</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64231"></a>64231</td>
<td class="instruction">RET NZ</td>
<td class="comment-11" rowspan="1">Return if not</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64232"></a>64232</td>
<td class="instruction">LD H,210</td>
<td class="comment-11" rowspan="1">210=ERIC</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64234"></a>64234</td>
<td class="instruction">CALL <a class="link" href="25012.html">25012</a></td>
<td class="comment-11" rowspan="1">Update the SRB for ERIC's current animatory state and location</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64237"></a>64237</td>
<td class="instruction">DEC D</td>
<td class="comment-11" rowspan="1">ERIC will rise one level as the plant grows</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="64238"></a>64238</td>
<td class="instruction">JP <a class="link" href="24880.html">24880</a></td>
<td class="comment-11" rowspan="1">Update ERIC's location and update the SRB</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="64076.html">64076</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#64077">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="64241.html">64241</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The complete Back to Skool RAM disassembly 20150415</div>
<div class="copyright">&#169; 1985 Microsphere Computer Services Ltd (Back to Skool). &#169; 2015 Richard Dymond (this disassembly).</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 4.3.</div>
</div>
</body>
</html>